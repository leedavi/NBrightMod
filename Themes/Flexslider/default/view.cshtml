@inherits NBrightMod.render.NBrightModRazorTokens<NBrightDNN.NBrightRazor>
@using System.Linq
@using NBrightDNN

@AddPreProcessMetaData("orderby", "ORDER BY NB1.XMLData.value('(genxml/hidden/sortrecordorder)[1]','int')", "Flexslider.view.cshtml", Model.ModuleId.ToString(""))

@{
    var msg = "";
    if (Model.Settings != null && !Model.Settings.ContainsKey("imgresize")) // test specific theme setting to check for settings.
    {
        msg = ResourceKey("View.nosettings").ToString();
    }
        var divid = "NBrightMod" + @Model.GetSetting("modref");
}
@(msg)

<div class="flexslider" id="@(divid)">
    <ul class="slides">

        @{
            var lp = 1;
        }
        @foreach (NBrightInfo info in Model.List)
        {
            var imageurl = info.GetXmlProperty("genxml/imgs/genxml[1]/hidden/imageurl");
            <li>
                @if (imageurl != "")
                {
                    var width = Model.GetSetting("width");
                    var height = Model.GetSetting("height");
                    var title = info.GetXmlProperty("genxml/lang/genxml/textbox/title");
                    <img src="/DesktopModules/NBright/NBrightData/NBrightThumb.ashx?src=@(imageurl)&w=@(width)&h=@(height)" alt="@(title)" />
                }
                <div class="flex-caption">
                    <h3>@info.GetXmlProperty("genxml/lang/genxml/textbox/title")</h3>
                    <h3>@info.GetXmlProperty("genxml/lang/genxml/textbox/title2")</h3>
                    <p>@BreakOf(info, "genxml/lang/genxml/textbox/text")</p>
                    @if (info.GetXmlProperty("genxml/lang/genxml/textbox/linktext") != "")
                    {
                        var tabddl = @GetTabUrlByGuid(info, "/genxml/dropdownlist/linktab");
                        <a href="@(tabddl)" class="bigbutton">@info.GetXmlProperty("genxml/lang/genxml/textbox/linktext")</a>
                    }
                </div>
            </li>

            lp+=1;
        }

    </ul>
</div>

        <script type="text/javascript">
            $(document).ready(function() {

                $('#@(divid)').flexslider({
                    slideshowSpeed: 4000,
                    controlNav: true
                });

            });
        </script>
<style>
/* FLEXSLIDER */
.flexslider {width:1154px;height:575px;overflow:hidden;}
.flexslider ul, .flexslider li {margin:0;padding:0;}
.flexslider ul li {list-style-type:none;margin:0;padding:0;}
/* Direction Nav */
.flex-direction-nav a {width:35px;height:70px;margin:-35px 0 0 0;background: url(/Portals/0/flexslider_nav.png) no-repeat 0 0;}
.flex-direction-nav .flex-next {right:-35px;}
.flex-direction-nav .flex-prev {left:-35px;}
.flexslider:hover .flex-next {right:0;}
.flexslider:hover .flex-prev {left:0;}
@@media screen and (max-width:1180px) {
.flexslider {width:auto;height:auto;}
}
</style>