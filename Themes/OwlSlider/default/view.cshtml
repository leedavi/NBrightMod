@inherits NBrightMod.render.NBrightModRazorTokens<NBrightDNN.NBrightRazor>
@using System.Linq
@using NBrightDNN

@AddMetaData("resourcepath","/DesktopModules/NBright/NBrightMod/Themes/OwlSlider/resx/")

@{
    var info = (NBrightInfo)Model.List.First();
}

@AddMetaData("resourcepath", "/DesktopModules/NBright/NBrightMod/App_LocalResources/")
@AddPreProcessMetaData("orderby", "ORDER BY NB1.XMLData.value('(genxml/hidden/sortrecordorder)[1]','int')", "OwlSlider.view.cshtml" + info.ModuleId)

@{
    var msg = "";
    if (Model.Settings != null && !Model.Settings.ContainsKey("imgresize")) // test specific theme setting to check for settings.
    {
        msg = ResourceKey("View.nosettings").ToString();
    }
        var divid = "NBrightMod" + @Model.GetSetting("modref");
}
@(msg) 

<div id="@(divid)" class="owl-carousel">

    
    @foreach (NBrightInfo x in Model.List)
        {
        var imageurl = x.GetXmlProperty("genxml/imgs/genxml[1]/hidden/imageurl");
        <div class="item">
            @if (imageurl != "")
            {
                var width = Model.GetSetting("width");
                var height = Model.GetSetting("height");
                var title = x.GetXmlProperty("genxml/lang/genxml/textbox/title");
                <img src="/DesktopModules/NBright/NBrightData/NBrightThumb.ashx?src=@(imageurl)&w=@(width)&h=@(height)" alt="@(title)"/>
            }
            @if (!x.GetXmlPropertyBool("genxml/checkbox/hidedescription"))
            {
            <span class="owl-carousel-caption">@HtmlOf(x, "genxml/lang/genxml/textbox/infodesc")</span>
            }
        </div>
        }
    </div>
@if (Model.List.Count > 1)
{
    <script type="text/javascript">
        $(window).load(function() {

            $('#@(divid)').owlCarousel({
                animateOut: '@Model.GetSetting("animateout")',
                animateIn: '@Model.GetSetting("animatein")',
                loop: @Model.GetSetting("loop"),
                autoplay: @Model.GetSetting("autoplay"),
                margin: @Model.GetSetting("margin"),
                items: @Model.GetSetting("items"),
                center: @Model.GetSetting("center"),
                smartSpeed: @Model.GetSetting("smartspeed")
            });

        });
    </script>
}
else
{
    if (Model.List.Count == 1)
     {
        <div>@ResourceKey("View.imgmessage")</div>     
     }
}
